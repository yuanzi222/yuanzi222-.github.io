<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta http-equiv="Cache-Control" content="no-siteapp"><meta http-equiv="Cache-Control" content="no-transform"><meta name="renderer" content="webkit|ie-comp|ie-stand"><meta name="apple-mobile-web-app-capable" content="元子的博客"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="browsermode" content="application"><meta name="screen-orientation" content="portrait"><link rel="dns-prefetch" href="https://yuanzi222.com"><meta name="keywords" content="Java"><meta name="description" content="今天突然想起有必要总结一下市面上通用的一些网络请求方式，主要通过分析其优缺点和性能，为以后选择网络请求连接方式提供支持。现在常用的网络请求方式主要有：HttpClient、HttpURLConn..."><meta name="robots" content="all"><meta name="google" content="all"><meta name="googlebot" content="all"><meta name="verify" content="all"><title>HttpClient、HttpURLConnection、OKHttp和Volley | 元子的博客</title><link rel="alternate" href="/atom.xml" title="元子的博客" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7"><link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0"><link rel="stylesheet" href="/css/style.css?rev=@@hash"></head></html><!--[if lte IE 8]><style>
    html{ font-size: 1em }
</style><![endif]--><!--[if lte IE 9]><div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div><![endif]--><body><header class="main-header" style="background-image:url(https://image.yuanzi222.com/blog/homeImages/banner.jpg)"><div class="main-header-box"> <a class="header-avatar" href="/" title="xueyya"><img src="https://image.yuanzi222.com/blog/homeImages/avatar.jpg" alt="logo头像" class="img-responsive center-block"></a><div class="branding"><h2> 记录学习的技能和遇到的问题</h2></div> <a href="https://github.com/yuanzi222" class="github-corner" aria-label="View source on Github" rel="external nofollow noopener noreferrer" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style></div></header><nav class="main-navigation"><div class="container"><div class="row"><div class="col-sm-12"><div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav"><span class="sr-only"></span><i class="fa fa-bars"></i></span> <a class="navbar-brand" href="https://yuanzi222.com">元子的博客</a></div><div class="collapse navbar-collapse" id="main-menu"><ul class="menu"><li role="presentation" class="text-center"><a href="/"><i class="fa fa-home"></i> 首页</a></li><li role="presentation" class="text-center"><a href="/categories/Java"><i class="fa fa-th"></i> Java</a></li><li role="presentation" class="text-center"><a href="/archives/"><i class="fa fa-archive"></i> 时间轴</a></li><li role="presentation" class="text-center"><a href="/game/"><i class="fa fa-gamepad"></i> 轻松一刻</a></li><li role="presentation" class="text-center"><a href="/about"><i class="fa fa-user"></i> 关于我</a></li></ul></div></div></div></div></nav><section class="content-wrap"><div class="container"><div class="row"><main class="col-md-8 main-content m-post"><p id="process"></p><article class="post"><div class="post-head"><h1 id="HttpClient、HttpURLConnection、OKHttp和Volley"> HttpClient、HttpURLConnection、OKHttp和Volley</h1><div class="post-meta"><span class="categories-meta fa-wrap"><i class="fa fa-folder-open-o"></i> 分类 <a class="category-link" href="/categories/Java/">Java</a></span><span class="fa-wrap"><i class="fa fa-tags"></i> <span class="tags-meta">标签 <a class="tag-link" href="/tags/Java/">Java</a></span></span><span class="fa-wrap"><i class="fa fa-calendar-o"></i> 发表日期 <span class="date-meta">2017/09/03</span></span><span class="fa-wrap"><i class="fa fa-eye"></i> 阅读数<span id="busuanzi_value_page_pv"></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> 本文字数 1.5k <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> 阅读时长 1 分钟</div></div></div><div class="post-body post-content"><p>今天突然想起有必要总结一下市面上通用的一些网络请求方式，主要通过分析其优缺点和性能，为以后选择网络请求连接方式提供支持。现在常用的网络请求方式主要有：<strong>HttpClient</strong>、<strong>HttpURLConnection</strong>、<strong>OKHttp</strong>和<strong>Volley</strong>。</p><h1 id="一、HttpClient："><a href="#一、HttpClient：" class="headerlink" title="一、HttpClient："></a>一、HttpClient：</h1><p><strong>HttpClient</strong> 是<strong>Apache</strong>的一个三方网络框架，网络请求做了完善的封装，<strong>api</strong>众多，用起来比较方便，开发快。实现比较稳定，<strong>bug</strong>比较少，但是正式由于其<strong>api</strong>众多，是我们很难再不破坏兼容性的情况下对其进行扩展。所以，<strong>Android</strong>团队对提升和优化<strong>httpclient</strong>积极性并不高。<strong>android5.0</strong>被废弃，<strong>6.0</strong>逐渐删除。</p><h1 id="二、HttpURLConnection"><a href="#二、HttpURLConnection" class="headerlink" title="二、HttpURLConnection"></a>二、HttpURLConnection</h1><p><strong>HttpURLConnection</strong>是一个多用途、轻量级的<strong>http</strong>客户端。它对网络请求的封装没有<strong>HttpClient</strong>彻底，<strong>api</strong>比较简单，用起来没有那么方便。但是正是由于此，使得我们能更容易的扩展和优化的<strong>HttpURLConnection</strong>。不过，再<strong>android2.2</strong>之前一直存在着一些令人烦的<strong>bug</strong>，比如一个人可读的<strong>inputstream</strong>调用它的<strong>close</strong>方法的时候，会使得连接池实效，通常的做法就是禁用连接池。因此，在<strong>android2.2</strong>之前建议使用稳定的HttpClient，<strong>android2.2</strong>之后使用更容易扩展和优化的<strong>HttpURLConnection</strong>。</p><h1 id="三、okhttp"><a href="#三、okhttp" class="headerlink" title="三、okhttp"></a>三、okhttp</h1><ul><li>支持<strong>Android 2.3</strong>及其以上版本；</li><li>支持<strong>Java JDK 1.7</strong>以上版本；</li></ul><p><strong>okhttp</strong>是专注于提升网络连接效率的<strong>http</strong>客户端。</p><ol><li>它能实现同一<strong>ip</strong>和端口的请求重用一个<strong>socket</strong>，这种方式能大大降低网络连接的时间，和每次请求都建立<strong>socket</strong>，再断开<strong>socket</strong>的方式相比，降低了服务器服务器的压力。</li><li><strong>okhttp</strong> 对<strong>http</strong>和<strong>https</strong>都有良好的支持。</li><li><strong>okhttp</strong> 不用担心<strong>android</strong>版本变换的困扰。</li><li>成熟的网络请求解决方案，比<strong>HttpURLConnection</strong>更好用。</li><li>缺点，<strong>okhttp</strong>请求网络切换回来是在线程里面的，不是在主线程，不能直接刷新<strong>UI</strong>，需要我们手动处理。封装比较麻烦。</li></ol><h1 id="四、Volley"><a href="#四、Volley" class="headerlink" title="四、Volley"></a>四、Volley</h1><p><strong>Volley</strong>是<strong>google</strong>在<strong>2013 io</strong>大会上推出的网络通信框架，特别适合处理数据量小，通信频繁的网络操作。优点是内部封装了异步线程，可直接在主线程请求网络，并处理返回的结果。同时可以取消请求，容易扩展。缺点是：面对大数据量的请求，比如下载表现糟糕，不支持<strong>https</strong>。<strong>Volley</strong>的底层在针对<strong>android2.3</strong>以下系统使用<strong>httpclicent</strong>，在<strong>android2.3</strong>以上采用<strong>HttpUrlConnection</strong>请求网络。</p><p>本公司的选择：<br>公司使用<strong>Volley</strong>框架来处理网络请求，但是，当数据量需求越来大的时候，<strong>Volley</strong>在面对大数据量的网络请求的表现并不好，加上公司大量采用<strong>https</strong>协议。于是，公司网络请求采用了<strong>Volley</strong>＋<strong>okhttp</strong>。正如我们采用这种方式的优势有：</p><ol><li><strong>okhttp</strong> 不用担心<strong>android</strong>版本变换的困扰。</li><li><strong>okhttp</strong> 对大数据量的网络请求支持非常好。</li><li><strong>okhttp</strong> 同时支持<strong>http</strong>和<strong>https</strong></li><li><strong>okhttp</strong> 重用<strong>socket</strong>连接，网络请求效率非常高。</li><li><strong>Volley</strong>框架在异步请求的封装非常好，对子线程网络请求，主线程更新UI支持非常好。能像<strong>Image-Loader</strong>一样轻松加载网络图片。<br>总之，网络请求底层采用<strong>okhttp</strong>，异步回调使用<strong>Volley</strong>框架。</li></ol></div><div class="reward" ontouchstart=""><div class="reward-wrap">赏<div class="reward-box"> <span class="reward-type"><img class="alipay" src="https://image.yuanzi222.com/blog/homeImages/alipay.jpg"><b>支付宝打赏</b></span> <span class="reward-type"><img class="wechat" src="https://image.yuanzi222.com/blog/homeImages/wechatpay.png"><b>微信打赏</b></span></div></div><p class="reward-tip">坚持原创技术分享,您的支持将鼓励我继续创作!</p></div><div class="post-footer"><div> 转载声明：商业转载请联系作者获得授权,非商业转载请注明出处<i class="fa fa-creative-commons"></i> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank">署名-非商业性使用-禁止演绎 4.0 国际</a></div><div></div></div><div class="addthis_inline_share_toolbox"><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5b63c2f14fb3c2a8" async="async"></script></div></article><div class="article-nav prev-next-wrap clearfix"><a href="/BIO、NIO与AIO的区别.html" class="pre-post btn btn-default" title="BIO、NIO与AIO的区别"><i class="fa fa-angle-left fa-fw"></i> <span class="hidden-lg">上一篇</span> <span class="hidden-xs">BIO、NIO与AIO的区别</span></a> <a href="/Linux SSH各配置项详解.html" class="next-post btn btn-default" title="Linux SSH各配置项详解"><span class="hidden-lg">下一篇</span> <span class="hidden-xs">Linux SSH各配置项详解</span><i class="fa fa-angle-right fa-fw"></i></a></div><div id="comments"><p>评论系统未开启，无法评论！</p></div></main><aside id="article-toc" role="navigation" class="col-md-4"><div class="widget"><h3 class="title">文章目录</h3><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#一、HttpClient："><span class="toc-text">一、HttpClient：</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#二、HttpURLConnection"><span class="toc-text">二、HttpURLConnection</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#三、okhttp"><span class="toc-text">三、okhttp</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#四、Volley"><span class="toc-text">四、Volley</span></a></li></ol></div></aside></div></div></section><footer class="main-footer"><div class="container"><div class="row"></div></div></footer><a id="back-to-top" class="icon-btn hide"><i class="fa fa-chevron-up"></i></a><div class="copyright"><div class="container"><div class="row"><div class="col-sm-12"><div class="busuanzi"> <span class="post-count">博客全站共34.4k字</span> | &nbsp; 访问量:<strong id="busuanzi_value_site_pv"><i class="fa fa-spinner fa-spin"></i></strong> &nbsp; | &nbsp; 访客数:<strong id="busuanzi_value_site_uv"><i class="fa fa-spinner fa-spin"></i></strong></div></div><div class="col-sm-12"> <span itemprop="copyrightYear">© 2016 - 2019</span> | <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span> |<script>var now=new Date;function createtime(){var n=new Date("07/21/2016 09:26:12");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="本站已稳定运行 "+dnum+" 天 ",document.getElementById("times").innerHTML=hnum+" 小时 "+mnum+" 分 "+snum+" 秒"}setInterval("createtime()",250)</script> <span><a href="//yuanzi222.com" class="copyright-links" target="_blank" rel="nofollow">元子的博客</a>&nbsp; |</span> <span><a href="http://beian.miit.gov.cn/publish/query/indexFirst.action" class="copyright-links" target="_blank" rel="external nofollow noopener noreferrer">京ICP备19057262号-1</a>&nbsp; |</span> <span><img src="https://image.yuanzi222.com/blog/homeImages/beiAn.png"> <a target="_blank" style="color:#939393" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010802030582" rel="external nofollow noopener noreferrer">京公网安备 11010802030582号</a></span></div></div></div></div><script src="/assets/tagcanvas.min.js?rev=2.9"></script><script>var tagOption={textColour:"#444",outlineMethod:"block",outlineColour:"#FFDAB9",interval:30,textHeight:13,outlineRadius:3,freezeActive:!0,frontSelect:!0,initial:[.1,-.1],depth:.5,decel:.95,maxSpeed:.03,reverse:!0,fadeIn:500,wheelZoom:""};TagCanvas.Start("tag-cloud-3d","",tagOption)</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/app.js?rev=@@hash"></script></body>