<!DOCTYPE html><html class="theme-next mist use-motion" lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0"><link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"6.3.0",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!1,fastclick:!1,lazyload:!1,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><script>!function(e,t,o,c,a,i,n){e.DaoVoiceObject=a,e[a]=e[a]||function(){(e[a].q=e[a].q||[]).push(arguments)},e[a].l=1*new Date,i=t.createElement(o),n=t.getElementsByTagName(o)[0],i.async=1,i.src=c,i.charset="utf-8",n.parentNode.insertBefore(i,n)}(window,document,"script",("https:"==document.location.protocol?"https:":"http:")+"//widget.daovoice.io/widget/a43e7bc3.js","daovoice"),daovoice("init",{app_id:"a43e7bc3"}),daovoice("update")</script><meta name="description" content="关于ssh设置的相关总结（ssh最大连接数、ssh连接时长、安全性配置等)，以redhat6.3为例: ssh配置文件在：/etc/ssh/sshd_config可以打开查看相应配置，默认情况下只开放了几个选项，其余全部#屏蔽掉了。 英文手册参考:http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config 国内有人已经翻译了：（直接贴过来了）"><meta name="keywords" content="Linux"><meta property="og:type" content="article"><meta property="og:title" content="Linux SSH各配置项详解"><meta property="og:url" content="https://yuanzi222.com/Linux SSH各配置项详解.html"><meta property="og:site_name" content="元子的博客"><meta property="og:description" content="关于ssh设置的相关总结（ssh最大连接数、ssh连接时长、安全性配置等)，以redhat6.3为例: ssh配置文件在：/etc/ssh/sshd_config可以打开查看相应配置，默认情况下只开放了几个选项，其余全部#屏蔽掉了。 英文手册参考:http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config 国内有人已经翻译了：（直接贴过来了）"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2018-10-29T02:50:06.255Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Linux SSH各配置项详解"><meta name="twitter:description" content="关于ssh设置的相关总结（ssh最大连接数、ssh连接时长、安全性配置等)，以redhat6.3为例: ssh配置文件在：/etc/ssh/sshd_config可以打开查看相应配置，默认情况下只开放了几个选项，其余全部#屏蔽掉了。 英文手册参考:http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config 国内有人已经翻译了：（直接贴过来了）"><link rel="alternate" href="/atom.xml" title="元子的博客" type="application/atom+xml"><link rel="canonical" href="https://yuanzi222.com/Linux SSH各配置项详解.html"><script type="text/javascript" id="page.configurations">CONFIG.page={sidebar:""}</script><title>Linux SSH各配置项详解 | 元子的博客</title><noscript><style type="text/css">.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.logo-line-after i{right:initial}</style></noscript></head><body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div> <a href="https://github.com/yuanzi222" class="github-corner" aria-label="View source on Github" rel="external nofollow noopener noreferrer" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">元子的博客</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">记录学习的技能和遇到的问题</h1></div><div class="site-nav-toggle"> <button aria-label="切换导航栏"><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://yuanzi222.com/Linux SSH各配置项详解.html"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="xueyya"><meta itemprop="description" content="做自己爱做的事，爱自己在做的事！"><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="元子的博客"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">Linux SSH各配置项详解</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2017-08-02 11:26:12" itemprop="dateCreated datePublished" datetime="2017-08-02T11:26:12+08:00">2017-08-02</time> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2018-10-29 10:50:06" itemprop="dateModified" datetime="2018-10-29T10:50:06+08:00">2018-10-29</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span></span> <span class="post-comments-count"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-comment-o"></i></span> <a href="/Linux SSH各配置项详解.html#comments" itemprop="discussionUrl"><span class="post-meta-item-text">评论数：</span><span class="post-comments-count valine-comment-count" data-xid="/Linux SSH各配置项详解.html" itemprop="commentCount"></span></a></span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i> 热度：<span class="busuanzi-value" id="busuanzi_value_page_pv"></span> <span>℃</span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">本文字数：</span> <span title="本文字数">13k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">12 分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><p>关于ssh设置的相关总结（ssh最大连接数、ssh连接时长、安全性配置等)，<strong>以redhat6.3为例:</strong></p><p>ssh配置文件在：/etc/ssh/sshd_config<br>可以打开查看相应配置，默认情况下只开放了几个选项，其余全部#屏蔽掉了。</p><p>英文手册参考:<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config" rel="external nofollow noopener noreferrer" target="_blank">http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config</a></p><p>国内有人已经翻译了：（直接贴过来了）</p><p>sshd_config中文手册:<br>SSHD_CONFIG(5) OpenBSD Programmer’s Manual SSHD_CONFIG(5)</p><p>名称sshd_config - OpenSSH SSH 服务器守护进程配置文件</p><p>描述<br>sshd(8) 默认从 /etc/ssh/sshd_config 文件(或通过 -f 命令行选项指定的文件)读取配置信息。<br>配置文件是由”指令 值”对组成的，每行一个。空行和以’#’开头的行都将被忽略。<br>如果值中含有空白符或者其他特殊符号，那么可以通过在两边加上双引号(“)进行界定。<br>[注意]值是大小写敏感的，但指令是大小写无关的。</p><h1 id="当前所有可以使用的配置指令如下"><a href="#当前所有可以使用的配置指令如下" class="headerlink" title="当前所有可以使用的配置指令如下:"></a>当前所有可以使用的配置指令如下:</h1><h2 id="AcceptEnv"><a href="#AcceptEnv" class="headerlink" title="AcceptEnv"></a>AcceptEnv</h2><p>指定客户端发送的哪些环境变量将会被传递到会话环境中。[注意]只有SSH-2协议支持环境变量的传递。<br>细节可以参考 ssh_config(5) 中的 SendEnv 配置指令。<br>指令的值是空格分隔的变量名列表(其中可以使用’*’和’?’作为通配符)。也可以使用多个 AcceptEnv 达到同样的目的。<br>需要注意的是，有些环境变量可能会被用于绕过禁止用户使用的环境变量。由于这个原因，该指令应当小心使用。<br>默认是不传递任何环境变量。</p><h2 id="AddressFamily"><a href="#AddressFamily" class="headerlink" title="AddressFamily"></a>AddressFamily</h2><p>指定 sshd(8) 应当使用哪种地址族。取值范围是：”any”(默认)、”inet”(仅IPv4)、”inet6”(仅IPv6)。</p><h2 id="AllowGroups"><a href="#AllowGroups" class="headerlink" title="AllowGroups"></a>AllowGroups</h2><p>这个指令后面跟着一串用空格分隔的组名列表(其中可以使用”*”和”?”通配符)。默认允许所有组登录。<br>如果使用了这个指令，那么将仅允许这些组中的成员登录，而拒绝其它所有组。<br>这里的”组”是指”主组”(primary group)，也就是/etc/passwd文件中指定的组。<br>这里只允许使用组的名字而不允许使用GID。相关的 allow/deny 指令按照下列顺序处理：<br>DenyUsers, AllowUsers, DenyGroups, AllowGroups</p><h2 id="AllowTcpForwarding"><a href="#AllowTcpForwarding" class="headerlink" title="AllowTcpForwarding"></a>AllowTcpForwarding</h2><p>是否允许TCP转发，默认值为”yes”。<br>禁止TCP转发并不能增强安全性，除非禁止了用户对shell的访问，因为用户可以安装他们自己的转发器。</p><h2 id="AllowUsers"><a href="#AllowUsers" class="headerlink" title="AllowUsers"></a>AllowUsers</h2><p>这个指令后面跟着一串用空格分隔的用户名列表(其中可以使用”*”和”?”通配符)。默认允许所有用户登录。<br>如果使用了这个指令，那么将仅允许这些用户登录，而拒绝其它所有用户。<br>如果指定了 USER@HOST 模式的用户，那么 USER 和 HOST 将同时被检查。<br>这里只允许使用用户的名字而不允许使用UID。相关的 allow/deny 指令按照下列顺序处理：<br>DenyUsers, AllowUsers, DenyGroups, AllowGroups</p><h2 id="AuthorizedKeysFile"><a href="#AuthorizedKeysFile" class="headerlink" title="AuthorizedKeysFile"></a>AuthorizedKeysFile</h2><p>存放该用户可以用来登录的 RSA/DSA 公钥。<br>该指令中可以使用下列根据连接时的实际情况进行展开的符号：<br>%% 表示’%’、%h 表示用户的主目录、%u 表示该用户的用户名。<br>经过扩展之后的值必须要么是绝对路径，要么是相对于用户主目录的相对路径。<br>默认值是”.ssh/authorized_keys”。</p><h2 id="Banner"><a href="#Banner" class="headerlink" title="Banner"></a>Banner</h2><p>将这个指令指定的文件中的内容在用户进行认证前显示给远程用户。<br>这个特性仅能用于SSH-2，默认什么内容也不显示。”none”表示禁用这个特性。</p><h2 id="ChallengeResponseAuthentication"><a href="#ChallengeResponseAuthentication" class="headerlink" title="ChallengeResponseAuthentication"></a>ChallengeResponseAuthentication</h2><p>是否允许质疑-应答(challenge-response)认证。默认值是”yes”。<br>所有 login.conf(5) 中允许的认证方式都被支持。</p><h2 id="Ciphers"><a href="#Ciphers" class="headerlink" title="Ciphers"></a>Ciphers</h2><p>指定SSH-2允许使用的加密算法。多个算法之间使用逗号分隔。可以使用的算法如下：<br>“aes128-cbc”, “aes192-cbc”, “aes256-cbc”, “aes128-ctr”, “aes192-ctr”, “aes256-ctr”,<br>“3des-cbc”, “arcfour128”, “arcfour256”, “arcfour”, “blowfish-cbc”, “cast128-cbc”<br>默认值是可以使用上述所有算法。</p><h2 id="ClientAliveCountMax"><a href="#ClientAliveCountMax" class="headerlink" title="ClientAliveCountMax"></a>ClientAliveCountMax</h2><p>sshd(8) 在未收到任何客户端回应前最多允许发送多少个”alive”消息。默认值是 3 。<br>到达这个上限后，sshd(8) 将强制断开连接、关闭会话。<br>需要注意的是，”alive”消息与 TCPKeepAlive 有很大差异。<br>“alive”消息是通过加密连接发送的，因此不会被欺骗；而 TCPKeepAlive 却是可以被欺骗的。<br>如果 ClientAliveInterval 被设为 15 并且将 ClientAliveCountMax 保持为默认值，<br>那么无应答的客户端大约会在45秒后被强制断开。这个指令仅可以用于SSH-2协议。</p><h2 id="ClientAliveInterval"><a href="#ClientAliveInterval" class="headerlink" title="ClientAliveInterval"></a>ClientAliveInterval</h2><p>设置一个以秒记的时长，如果超过这么长时间没有收到客户端的任何数据，<br>sshd(8) 将通过安全通道向客户端发送一个”alive”消息，并等候应答。<br>默认值 0 表示不发送”alive”消息。这个选项仅对SSH-2有效。</p><h2 id="Compression"><a href="#Compression" class="headerlink" title="Compression"></a>Compression</h2><p>是否对通信数据进行加密，还是延迟到认证成功之后再对通信数据加密。<br>可用值：”yes”, “delayed”(默认), “no”。</p><h2 id="DenyGroups"><a href="#DenyGroups" class="headerlink" title="DenyGroups"></a>DenyGroups</h2><p>这个指令后面跟着一串用空格分隔的组名列表(其中可以使用”*”和”?”通配符)。默认允许所有组登录。<br>如果使用了这个指令，那么这些组中的成员将被拒绝登录。<br>这里的”组”是指”主组”(primary group)，也就是/etc/passwd文件中指定的组。<br>这里只允许使用组的名字而不允许使用GID。相关的 allow/deny 指令按照下列顺序处理：<br>DenyUsers, AllowUsers, DenyGroups, AllowGroups</p><h2 id="DenyUsers"><a href="#DenyUsers" class="headerlink" title="DenyUsers"></a>DenyUsers</h2><p>这个指令后面跟着一串用空格分隔的用户名列表(其中可以使用”*”和”?”通配符)。默认允许所有用户登录。<br>如果使用了这个指令，那么这些用户将被拒绝登录。<br>如果指定了 USER@HOST 模式的用户，那么 USER 和 HOST 将同时被检查。<br>这里只允许使用用户的名字而不允许使用UID。相关的 allow/deny 指令按照下列顺序处理：<br>DenyUsers, AllowUsers, DenyGroups, AllowGroups</p><h2 id="ForceCommand"><a href="#ForceCommand" class="headerlink" title="ForceCommand"></a>ForceCommand</h2><p>强制执行这里指定的命令而忽略客户端提供的任何命令。这个命令将使用用户的登录shell执行(shell -c)。<br>这可以应用于 shell 、命令、子系统的完成，通常用于 Match 块中。<br>这个命令最初是在客户端通过 SSH_ORIGINAL_COMMAND 环境变量来支持的。</p><h2 id="GatewayPorts"><a href="#GatewayPorts" class="headerlink" title="GatewayPorts"></a>GatewayPorts</h2><p>是否允许远程主机连接本地的转发端口。默认值是”no”。<br>sshd(8) 默认将远程端口转发绑定到loopback地址。这样将阻止其它远程主机连接到转发端口。<br>GatewayPorts 指令可以让 sshd 将远程端口转发绑定到非loopback地址，这样就可以允许远程主机连接了。<br>“no”表示仅允许本地连接，”yes”表示强制将远程端口转发绑定到统配地址(wildcard address)，<br>“clientspecified”表示允许客户端选择将远程端口转发绑定到哪个地址。</p><h2 id="GSSAPIAuthentication"><a href="#GSSAPIAuthentication" class="headerlink" title="GSSAPIAuthentication"></a>GSSAPIAuthentication</h2><p>是否允许使用基于 GSSAPI 的用户认证。默认值为”no”。仅用于SSH-2。</p><h2 id="GSSAPICleanupCredentials"><a href="#GSSAPICleanupCredentials" class="headerlink" title="GSSAPICleanupCredentials"></a>GSSAPICleanupCredentials</h2><p>是否在用户退出登录后自动销毁用户凭证缓存。默认值是”yes”。仅用于SSH-2。</p><h2 id="HostbasedAuthentication"><a href="#HostbasedAuthentication" class="headerlink" title="HostbasedAuthentication"></a>HostbasedAuthentication</h2><p>这个指令与 RhostsRSAAuthentication 类似，但是仅可以用于SSH-2。推荐使用默认值”no”。<br>推荐使用默认值”no”禁止这种不安全的认证方式。</p><h2 id="HostbasedUsesNameFromPacketOnly"><a href="#HostbasedUsesNameFromPacketOnly" class="headerlink" title="HostbasedUsesNameFromPacketOnly"></a>HostbasedUsesNameFromPacketOnly</h2><p>在开启 HostbasedAuthentication 的情况下，<br>指定服务器在使用 ~/.shosts ~/.rhosts /etc/hosts.equiv 进行远程主机名匹配时，是否进行反向域名查询。<br>“yes”表示 sshd(8) 信任客户端提供的主机名而不进行反向查询。默认值是”no”。</p><h2 id="HostKey"><a href="#HostKey" class="headerlink" title="HostKey"></a>HostKey</h2><p>主机私钥文件的位置。如果权限不对，sshd(8) 可能会拒绝启动。<br>SSH-1默认是 /etc/ssh/ssh_host_key 。<br>SSH-2默认是 /etc/ssh/ssh_host_rsa_key 和 /etc/ssh/ssh_host_dsa_key 。<br>一台主机可以拥有多个不同的私钥。”rsa1”仅用于SSH-1，”dsa”和”rsa”仅用于SSH-2。</p><h2 id="IgnoreRhosts"><a href="#IgnoreRhosts" class="headerlink" title="IgnoreRhosts"></a>IgnoreRhosts</h2><p>是否在 RhostsRSAAuthentication 或 HostbasedAuthentication 过程中忽略 .rhosts 和 .shosts 文件。<br>不过 /etc/hosts.equiv 和 /etc/shosts.equiv 仍将被使用。推荐设为默认值”yes”。</p><h2 id="IgnoreUserKnownHosts"><a href="#IgnoreUserKnownHosts" class="headerlink" title="IgnoreUserKnownHosts"></a>IgnoreUserKnownHosts</h2><p>是否在 RhostsRSAAuthentication 或 HostbasedAuthentication 过程中忽略用户的 ~/.ssh/known_hosts 文件。<br>默认值是”no”。为了提高安全性，可以设为”yes”。</p><h2 id="KerberosAuthentication"><a href="#KerberosAuthentication" class="headerlink" title="KerberosAuthentication"></a>KerberosAuthentication</h2><p>是否要求用户为 PasswordAuthentication 提供的密码必须通过 Kerberos KDC 认证，也就是是否使用Kerberos认证。<br>要使用Kerberos认证，服务器需要一个可以校验 KDC identity 的 Kerberos servtab 。默认值是”no”。</p><h2 id="KerberosGetAFSToken"><a href="#KerberosGetAFSToken" class="headerlink" title="KerberosGetAFSToken"></a>KerberosGetAFSToken</h2><p>如果使用了 AFS 并且该用户有一个 Kerberos 5 TGT，那么开启该指令后，<br>将会在访问用户的家目录前尝试获取一个 AFS token 。默认为”no”。</p><h2 id="KerberosOrLocalPasswd"><a href="#KerberosOrLocalPasswd" class="headerlink" title="KerberosOrLocalPasswd"></a>KerberosOrLocalPasswd</h2><p>如果 Kerberos 密码认证失败，那么该密码还将要通过其它的认证机制(比如 /etc/passwd)。<br>默认值为”yes”。</p><h2 id="KerberosTicketCleanup"><a href="#KerberosTicketCleanup" class="headerlink" title="KerberosTicketCleanup"></a>KerberosTicketCleanup</h2><p>是否在用户退出登录后自动销毁用户的 ticket 。默认值是”yes”。</p><h2 id="KeyRegenerationInterval"><a href="#KeyRegenerationInterval" class="headerlink" title="KeyRegenerationInterval"></a>KeyRegenerationInterval</h2><p>在SSH-1协议下，短命的服务器密钥将以此指令设置的时间为周期(秒)，不断重新生成。<br>这个机制可以尽量减小密钥丢失或者黑客攻击造成的损失。<br>设为 0 表示永不重新生成，默认为 3600(秒)。</p><h2 id="ListenAddress"><a href="#ListenAddress" class="headerlink" title="ListenAddress"></a>ListenAddress</h2><p>指定 sshd(8) 监听的网络地址，默认监听所有地址。可以使用下面的格式：</p><h2 id="ListenAddress-1"><a href="#ListenAddress-1" class="headerlink" title="ListenAddress"></a>ListenAddress</h2><p>host|IPv4_addr|IPv6_addr<br>ListenAddress host|IPv4_addr:port<br>ListenAddress [host|IPv6_addr]:port</p><p>如果未指定 port ，那么将使用 Port 指令的值。<br>可以使用多个 ListenAddress 指令监听多个地址。</p><h2 id="LoginGraceTime"><a href="#LoginGraceTime" class="headerlink" title="LoginGraceTime"></a>LoginGraceTime</h2><p>限制用户必须在指定的时限内认证成功，0 表示无限制。默认值是 120 秒。</p><h2 id="LogLevel"><a href="#LogLevel" class="headerlink" title="LogLevel"></a>LogLevel</h2><p>指定 sshd(8) 的日志等级(详细程度)。可用值如下：<br>QUIET, FATAL, ERROR, INFO(默认), VERBOSE, DEBUG, DEBUG1, DEBUG2, DEBUG3<br>DEBUG 与 DEBUG1 等价；DEBUG2 和 DEBUG3 则分别指定了更详细、更罗嗦的日志输出。<br>比 DEBUG 更详细的日志可能会泄漏用户的敏感信息，因此反对使用。</p><h2 id="MACs"><a href="#MACs" class="headerlink" title="MACs"></a>MACs</h2><p>指定允许在SSH-2中使用哪些消息摘要算法来进行数据校验。<br>可以使用逗号分隔的列表来指定允许使用多个算法。默认值(包含所有可以使用的算法)是：<br>hmac-md5,hmac-sha1,<a href="mailto:umac-64@openssh.com" rel="external nofollow noopener noreferrer" target="_blank">umac-64@openssh.com</a>,hmac-ripemd160,hmac-sha1-96,hmac-md5-96</p><h2 id="Match"><a href="#Match" class="headerlink" title="Match"></a>Match</h2><p>引入一个条件块。块的结尾标志是另一个 Match 指令或者文件结尾。<br>如果 Match 行上指定的条件都满足，那么随后的指令将覆盖全局配置中的指令。<br>Match 的值是一个或多个”条件-模式”对。可用的”条件”是：User, Group, Host, Address 。<br>只有下列指令可以在 Match 块中使用：AllowTcpForwarding, Banner,<br>ForceCommand, GatewayPorts, GSSApiAuthentication,<br>KbdInteractiveAuthentication, KerberosAuthentication,<br>PasswordAuthentication, PermitOpen, PermitRootLogin,<br>RhostsRSAAuthentication, RSAAuthentication, X11DisplayOffset,<br>X11Forwarding, X11UseLocalHost</p><h2 id="MaxAuthTries"><a href="#MaxAuthTries" class="headerlink" title="MaxAuthTries"></a>MaxAuthTries</h2><p>指定每个连接最大允许的认证次数。默认值是 6 。<br>如果失败认证的次数超过这个数值的一半，连接将被强制断开，且会生成额外的失败日志消息。</p><h2 id="MaxStartups"><a href="#MaxStartups" class="headerlink" title="MaxStartups"></a>MaxStartups</h2><p>最大允许保持多少个未认证的连接。默认值是 10 。<br>到达限制后，将不再接受新连接，除非先前的连接认证成功或超出 LoginGraceTime 的限制。</p><h2 id="PasswordAuthentication"><a href="#PasswordAuthentication" class="headerlink" title="PasswordAuthentication"></a>PasswordAuthentication</h2><p>是否允许使用基于密码的认证。默认为”yes”。</p><h2 id="PermitEmptyPasswords"><a href="#PermitEmptyPasswords" class="headerlink" title="PermitEmptyPasswords"></a>PermitEmptyPasswords</h2><p>是否允许密码为空的用户远程登录。默认为”no”。</p><h2 id="PermitOpen"><a href="#PermitOpen" class="headerlink" title="PermitOpen"></a>PermitOpen</h2><p>指定TCP端口转发允许的目的地，可以使用空格分隔多个转发目标。默认允许所有转发请求。<br>合法的指令格式如下：<br>PermitOpen host:port<br>PermitOpen IPv4_addr:port<br>PermitOpen [IPv6_addr]:port<br>“any”可以用于移除所有限制并允许一切转发请求。</p><h2 id="PermitRootLogin"><a href="#PermitRootLogin" class="headerlink" title="PermitRootLogin"></a>PermitRootLogin</h2><p>是否允许 root 登录。可用值如下：<br>“yes”(默认) 表示允许。”no”表示禁止。<br>“without-password”表示禁止使用密码认证登录。<br>“forced-commands-only”表示只有在指定了 command 选项的情况下才允许使用公钥认证登录。<br>同时其它认证方法全部被禁止。这个值常用于做远程备份之类的事情。</p><h2 id="PermitTunnel"><a href="#PermitTunnel" class="headerlink" title="PermitTunnel"></a>PermitTunnel</h2><p>是否允许 tun(4) 设备转发。可用值如下：<br>“yes”, “point-to-point”(layer 3), “ethernet”(layer 2), “no”(默认)。<br>“yes”同时蕴含着”point-to-point”和”ethernet”。</p><h2 id="PermitUserEnvironment"><a href="#PermitUserEnvironment" class="headerlink" title="PermitUserEnvironment"></a>PermitUserEnvironment</h2><p>指定是否允许 sshd(8) 处理 ~/.ssh/environment 以及 ~/.ssh/authorized_keys 中的 environment= 选项。<br>默认值是”no”。如果设为”yes”可能会导致用户有机会使用某些机制(比如 LD_PRELOAD)绕过访问控制，造成安全漏洞。</p><h2 id="PidFile"><a href="#PidFile" class="headerlink" title="PidFile"></a>PidFile</h2><p>指定在哪个文件中存放SSH守护进程的进程号，默认为 /var/run/sshd.pid 文件。</p><h2 id="Port"><a href="#Port" class="headerlink" title="Port"></a>Port</h2><p>指定 sshd(8) 守护进程监听的端口号，默认为 22 。可以使用多条指令监听多个端口。<br>默认将在本机的所有网络接口上监听，但是可以通过 ListenAddress 指定只在某个特定的接口上监听。</p><h2 id="PrintLastLog"><a href="#PrintLastLog" class="headerlink" title="PrintLastLog"></a>PrintLastLog</h2><p>指定 sshd(8) 是否在每一次交互式登录时打印最后一位用户的登录时间。默认值是”yes”。</p><h2 id="PrintMotd"><a href="#PrintMotd" class="headerlink" title="PrintMotd"></a>PrintMotd</h2><p>指定 sshd(8) 是否在每一次交互式登录时打印 /etc/motd 文件的内容。默认值是”yes”。</p><h2 id="Protocol"><a href="#Protocol" class="headerlink" title="Protocol"></a>Protocol</h2><p>指定 sshd(8) 支持的SSH协议的版本号。<br>‘1’和’2’表示仅仅支持SSH-1和SSH-2协议。”2,1”表示同时支持SSH-1和SSH-2协议。</p><h2 id="PubkeyAuthentication"><a href="#PubkeyAuthentication" class="headerlink" title="PubkeyAuthentication"></a>PubkeyAuthentication</h2><p>是否允许公钥认证。仅可以用于SSH-2。默认值为”yes”。</p><h2 id="RhostsRSAAuthentication"><a href="#RhostsRSAAuthentication" class="headerlink" title="RhostsRSAAuthentication"></a>RhostsRSAAuthentication</h2><p>是否使用强可信主机认证(通过检查远程主机名和关联的用户名进行认证)。仅用于SSH-1。<br>这是通过在RSA认证成功后再检查 ~/.rhosts 或 /etc/hosts.equiv 进行认证的。<br>出于安全考虑，建议使用默认值”no”。</p><h2 id="RSAAuthentication"><a href="#RSAAuthentication" class="headerlink" title="RSAAuthentication"></a>RSAAuthentication</h2><p>是否允许使用纯 RSA 公钥认证。仅用于SSH-1。默认值是”yes”。</p><h2 id="ServerKeyBits"><a href="#ServerKeyBits" class="headerlink" title="ServerKeyBits"></a>ServerKeyBits</h2><p>指定临时服务器密钥的长度。仅用于SSH-1。默认值是 768(位)。最小值是 512 。</p><h2 id="StrictModes"><a href="#StrictModes" class="headerlink" title="StrictModes"></a>StrictModes</h2><p>指定是否要求 sshd(8) 在接受连接请求前对用户主目录和相关的配置文件进行宿主和权限检查。<br>强烈建议使用默认值”yes”来预防可能出现的低级错误。</p><h2 id="Subsystem"><a href="#Subsystem" class="headerlink" title="Subsystem"></a>Subsystem</h2><p>配置一个外部子系统(例如，一个文件传输守护进程)。仅用于SSH-2协议。<br>值是一个子系统的名字和对应的命令行(含选项和参数)。比如”sft /bin/sftp-server”。</p><h2 id="SyslogFacility"><a href="#SyslogFacility" class="headerlink" title="SyslogFacility"></a>SyslogFacility</h2><p>指定 sshd(8) 将日志消息通过哪个日志子系统(facility)发送。有效值是：<br>DAEMON, USER, AUTH(默认), LOCAL0, LOCAL1, LOCAL2, LOCAL3, LOCAL4, LOCAL5, LOCAL6, LOCAL7</p><h2 id="TCPKeepAlive"><a href="#TCPKeepAlive" class="headerlink" title="TCPKeepAlive"></a>TCPKeepAlive</h2><p>指定系统是否向客户端发送 TCP keepalive 消息。默认值是”yes”。<br>这种消息可以检测到死连接、连接不当关闭、客户端崩溃等异常。<br>可以设为”no”关闭这个特性。</p><h2 id="UseDNS"><a href="#UseDNS" class="headerlink" title="UseDNS"></a>UseDNS</h2><p>指定 sshd(8) 是否应该对远程主机名进行反向解析，以检查此主机名是否与其IP地址真实对应。默认值为”yes”。</p><h2 id="UseLogin"><a href="#UseLogin" class="headerlink" title="UseLogin"></a>UseLogin</h2><p>是否在交互式会话的登录过程中使用 login(1) 。默认值是”no”。<br>如果开启此指令，那么 X11Forwarding 将会被禁止，因为 login(1) 不知道如何处理 xauth(1) cookies 。<br>需要注意的是，login(1) 是禁止用于远程执行命令的。<br>如果指定了 UsePrivilegeSeparation ，那么它将在认证完成后被禁用。</p><h2 id="UsePrivilegeSeparation"><a href="#UsePrivilegeSeparation" class="headerlink" title="UsePrivilegeSeparation"></a>UsePrivilegeSeparation</h2><p>是否让 sshd(8) 通过创建非特权子进程处理接入请求的方法来进行权限分离。默认值是”yes”。<br>认证成功后，将以该认证用户的身份创建另一个子进程。<br>这样做的目的是为了防止通过有缺陷的子进程提升权限，从而使系统更加安全。</p><h2 id="X11DisplayOffset"><a href="#X11DisplayOffset" class="headerlink" title="X11DisplayOffset"></a>X11DisplayOffset</h2><p>指定 sshd(8) X11 转发的第一个可用的显示区(display)数字。默认值是 10 。<br>这个可以用于防止 sshd 占用了真实的 X11 服务器显示区，从而发生混淆。</p><h2 id="X11Forwarding"><a href="#X11Forwarding" class="headerlink" title="X11Forwarding"></a>X11Forwarding</h2><p>是否允许进行 X11 转发。默认值是”no”，设为”yes”表示允许。<br>如果允许X11转发并且sshd(8)代理的显示区被配置为在含有通配符的地址(X11UseLocalhost)上监听。<br>那么将可能有额外的信息被泄漏。由于使用X11转发的可能带来的风险，此指令默认值为”no”。<br>需要注意的是，禁止X11转发并不能禁止用户转发X11通信，因为用户可以安装他们自己的转发器。<br>如果启用了 UseLogin ，那么X11转发将被自动禁止。</p><h2 id="X11UseLocalhost"><a href="#X11UseLocalhost" class="headerlink" title="X11UseLocalhost"></a>X11UseLocalhost</h2><p>sshd(8) 是否应当将X11转发服务器绑定到本地loopback地址。默认值是”yes”。<br>sshd 默认将转发服务器绑定到本地loopback地址并将 DISPLAY 环境变量的主机名部分设为”localhost”。<br>这可以防止远程主机连接到 proxy display 。不过某些老旧的X11客户端不能在此配置下正常工作。<br>为了兼容这些老旧的X11客户端，你可以设为”no”。</p><h2 id="XAuthLocation"><a href="#XAuthLocation" class="headerlink" title="XAuthLocation"></a>XAuthLocation</h2><p>指定 xauth(1) 程序的绝对路径。默认值是 /usr/X11R6/bin/xauth</p><h2 id="时间格式"><a href="#时间格式" class="headerlink" title="时间格式"></a>时间格式</h2><p>在 sshd(8) 命令行参数和配置文件中使用的时间值可以通过下面的格式指定：time[qualifier] 。<br>其中的 time 是一个正整数，而 qualifier 可以是下列单位之一：<br>&lt;无&gt; 秒<br>s | S 秒<br>m | M 分钟<br>h | H 小时<br>d | D 天<br>w | W 星期</p><p>可以通过指定多个数值来累加时间，比如：<br>1h30m 1 小时 30 分钟 (90 分钟)</p><p>文件<br>/etc/ssh/sshd_config<br>sshd(8) 的主配置文件。这个文件的宿主应当是root，权限最大可以是”644”。</p><p>参见<br>sshd(8)</p><p>作者<br>OpenSSH is a derivative of the original and free ssh 1.2.12 release by<br>Tatu Ylonen. Aaron Campbell, Bob Beck, Markus Friedl, Niels Provos, Theo<br>de Raadt and Dug Song removed many bugs, re-added newer features and cre-<br>ated OpenSSH. Markus Friedl contributed the support for SSH protocol<br>versions 1.5 and 2.0. Niels Provos and Markus Friedl contributed support<br>for privilege separation.</p><h1 id="OpenBSD-4-2-January-1-2008-9Vbird网络篇里的说明："><a href="#OpenBSD-4-2-January-1-2008-9Vbird网络篇里的说明：" class="headerlink" title="OpenBSD 4.2 January 1, 2008 9Vbird网络篇里的说明："></a>OpenBSD 4.2 January 1, 2008 9Vbird网络篇里的说明：</h1><h1 id="1-关于-SSH-Server-的整体设定-包含使用的-port-啦-以及使用的密码演算方式"><a href="#1-关于-SSH-Server-的整体设定-包含使用的-port-啦-以及使用的密码演算方式" class="headerlink" title="1. 关于 SSH Server 的整体设定,包含使用的 port 啦,以及使用的密码演算方式"></a>1. 关于 SSH Server 的整体设定,包含使用的 port 啦,以及使用的密码演算方式</h1><p>先留意一下,在预设的文件内,只要是被批注的设定值(#),即为『默认值!』</p><h2 id="Port-22"><a href="#Port-22" class="headerlink" title="Port 22"></a>Port 22</h2><p>SSH 预设使用 22 这个 port,也可以使用多个 port,即重复使用 port 这个设定项目! # 例如想要开放 sshd 在 22 与 443 ,则多加一行内容为:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># Port 443</span><br></pre></td></tr></table></figure><p>这样就好了!不过,不建议修改 port number</p><h2 id="rotocol-1-2"><a href="#rotocol-1-2" class="headerlink" title="rotocol 1,2"></a>rotocol 1,2</h2><p>选择的 SSH 协议版本,可以是 1 也可以是 2 ,如果要同时支持两者,就必须要使用 2,1 这个分隔了(Protocol 1,2)! # 目前我们会建议您,直接使用 Protocol 2 即可!</p><h2 id="ListenAddress-0-0-0-0"><a href="#ListenAddress-0-0-0-0" class="headerlink" title="ListenAddress 0.0.0.0"></a>ListenAddress 0.0.0.0</h2><p>监听的主机适配卡!举个例子来说,如果您有两个 IP,分别是 192.168.0.100 及 192.168.2.20 ,那么只想要开放 192.168.0.100 时,就可以写如同下面的样式:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ListenAddress 192.168.0.100</span><br></pre></td></tr></table></figure><p>只监听来自 192.168.0.100 这个 IP 的 SSH 联机。<br>如果不使用设定的话,则预设所有接口均接受 SSH</p><h2 id="PidFile-var-run-sshd-pid"><a href="#PidFile-var-run-sshd-pid" class="headerlink" title="PidFile /var/run/sshd.pid"></a>PidFile /var/run/sshd.pid</h2><p>可以放置 SSHD 这个 PID 的文件!左列为默认值</p><h2 id="LoginGraceTime-2m"><a href="#LoginGraceTime-2m" class="headerlink" title="LoginGraceTime 2m"></a>LoginGraceTime 2m</h2><p>当使用者连上 SSH server 之后,会出现输入密码的画面,在该画面中,在多久时间内没有成功连上 SSH server ,就断线!若无单位则预设时间为秒!</p><h2 id="Compression-yes"><a href="#Compression-yes" class="headerlink" title="Compression yes"></a>Compression yes</h2><p>是否可以使用压缩指令?当然可以</p><h1 id="2-说明主机的-Private-Key-放置的档案-预设使用下面的档案即可"><a href="#2-说明主机的-Private-Key-放置的档案-预设使用下面的档案即可" class="headerlink" title="2. 说明主机的 Private Key 放置的档案,预设使用下面的档案即可!"></a>2. 说明主机的 Private Key 放置的档案,预设使用下面的档案即可!</h1><p>HostKey /etc/ssh/ssh_host_key # SSH version 1 使用的私钥<br>HostKey /etc/ssh/ssh_host_rsa_key # SSH version 2 使用的 RSA 私钥<br>HostKey /etc/ssh/ssh_host_dsa_key # SSH version 2 使用的 DSA 私钥<br>还记得我们在主机的 SSH 联机流程里面谈到的,这里就是 Host Key</p><h2 id="2-1-关于-version-1-的一些设定"><a href="#2-1-关于-version-1-的一些设定" class="headerlink" title="2.1 关于 version 1 的一些设定!"></a>2.1 关于 version 1 的一些设定!</h2><h2 id="KeyRegenerationInterval-1h"><a href="#KeyRegenerationInterval-1h" class="headerlink" title="KeyRegenerationInterval 1h"></a>KeyRegenerationInterval 1h</h2><p>由前面联机的说明可以知道, version 1 会使用 server 的 Public Key ,那么如果这个 Public Key 被偷的话,岂不完蛋?所以需要每隔一段时间来重新建立一次!这里的时间为秒!不过我们通常都仅使用 version 2 ,所以这个设定可以被忽略喔!</p><h2 id="ServerKeyBits-768"><a href="#ServerKeyBits-768" class="headerlink" title="ServerKeyBits 768"></a>ServerKeyBits 768</h2><p>没错!这个就是 Server key 的长度!用默认值即可。</p><h1 id="3-关于登录文件的讯息数据放置与-daemon-的名称"><a href="#3-关于登录文件的讯息数据放置与-daemon-的名称" class="headerlink" title="3. 关于登录文件的讯息数据放置与 daemon 的名称!"></a>3. 关于登录文件的讯息数据放置与 daemon 的名称!</h1><h2 id="SyslogFacility-AUTHPRIV"><a href="#SyslogFacility-AUTHPRIV" class="headerlink" title="SyslogFacility AUTHPRIV"></a>SyslogFacility AUTHPRIV</h2><p>当有人使用 SSH 登入系统的时候,SSH 会记录信息,这个信息要记录在什么 daemon name底下?预设是以 AUTH 来设定的,即是 /var/log/secure 里面!其它可用的 daemon name 为:DAEMON,USER,AUTH,LOCAL0,LOCAL1,LOCAL2,LOCAL3,LOCAL4,LOCAL5,</p><h2 id="LogLevel-INFO"><a href="#LogLevel-INFO" class="headerlink" title="LogLevel INFO"></a>LogLevel INFO</h2><p>登录记录的等级!注意登机信息可参照vbird基础篇详解。</p><h1 id="4-安全设定项目-极重要"><a href="#4-安全设定项目-极重要" class="headerlink" title="4. 安全设定项目!极重要!"></a>4. 安全设定项目!极重要!</h1><h2 id="4-1-登入设定部分"><a href="#4-1-登入设定部分" class="headerlink" title="4.1 登入设定部分"></a>4.1 登入设定部分</h2><h2 id="PermitRootLogin-no"><a href="#PermitRootLogin-no" class="headerlink" title="PermitRootLogin no"></a>PermitRootLogin no</h2><p>是否允许 root 登入!预设是允许的,但是建议设定成 no!</p><h2 id="UserLogin-no"><a href="#UserLogin-no" class="headerlink" title="UserLogin no"></a>UserLogin no</h2><p>在 SSH 底下本来就不接受 login 这个程序的登入!</p><h2 id="StrictModes-yes"><a href="#StrictModes-yes" class="headerlink" title="StrictModes yes"></a>StrictModes yes</h2><p>当使用者的 host key 改变之后,Server 就不接受联机,可以抵挡部分的木马程序!</p><h2 id="RSAAuthentication-yes"><a href="#RSAAuthentication-yes" class="headerlink" title="RSAAuthentication yes"></a>RSAAuthentication yes</h2><p>是否使用纯的 RSA 认证!?仅针对 version 1 !</p><h2 id="PubkeyAuthentication-yes"><a href="#PubkeyAuthentication-yes" class="headerlink" title="PubkeyAuthentication yes"></a>PubkeyAuthentication yes</h2><p>是否允许 Public Key ?当然允许啦!仅针对 version 2</p><h2 id="AuthorizedKeysFile-ssh-authorized-keys"><a href="#AuthorizedKeysFile-ssh-authorized-keys" class="headerlink" title="AuthorizedKeysFile .ssh/authorized_keys"></a>AuthorizedKeysFile .ssh/authorized_keys</h2><p>上面这个在设定若要使用不需要密码登入的账号时,那么那个账号的存放密码所在文件名!</p><p><strong>这个设定值很重要喔!文件名记一下!</strong></p><h2 id="4-2-认证部分"><a href="#4-2-认证部分" class="headerlink" title="4.2 认证部分"></a>4.2 认证部分</h2><h2 id="RhostsAuthentication-no"><a href="#RhostsAuthentication-no" class="headerlink" title="RhostsAuthentication no"></a>RhostsAuthentication no</h2><p>本机系统不使用 .rhosts,因为仅使用 .rhosts 太不安全了,所以这里一定要设定为 no</p><h2 id="IgnoreRhosts-yes"><a href="#IgnoreRhosts-yes" class="headerlink" title="IgnoreRhosts yes"></a>IgnoreRhosts yes</h2><p>是否取消使用 ~/.ssh/.rhosts 来做为认证!当然是!</p><h2 id="RhostsRSAAuthentication-no"><a href="#RhostsRSAAuthentication-no" class="headerlink" title="RhostsRSAAuthentication no"></a>RhostsRSAAuthentication no</h2><p>这个选项是专门给 version 1 用的,使用 rhosts 文件在 /etc/hosts.equiv</p><p><strong>配合 RSA 演算方式来进行认证!不要使用啊!</strong></p><h2 id="HostbasedAuthentication-no"><a href="#HostbasedAuthentication-no" class="headerlink" title="HostbasedAuthentication no"></a>HostbasedAuthentication no</h2><p>这个项目与上面的项目类似,不过是给 version 2 使用的!</p><h2 id="IgnoreUserKnownHosts-no"><a href="#IgnoreUserKnownHosts-no" class="headerlink" title="IgnoreUserKnownHosts no"></a>IgnoreUserKnownHosts no</h2><p>是否忽略家目录内的 ~/.ssh/known_hosts 这个文件所记录的主机内容?当然不要忽略,所以这里就是 no 啦!</p><h2 id="PasswordAuthentication-yes"><a href="#PasswordAuthentication-yes" class="headerlink" title="PasswordAuthentication yes"></a>PasswordAuthentication yes</h2><p>密码验证当然是需要的!所以这里写 yes 啰!</p><h2 id="PermitEmptyPasswords-no"><a href="#PermitEmptyPasswords-no" class="headerlink" title="PermitEmptyPasswords no"></a>PermitEmptyPasswords no</h2><p>若上面那一项如果设定为 yes 的话,这一项就最好设定为 no</p><p><strong>这个项目在是否允许以空的密码登入!当然不许!</strong></p><h2 id="ChallengeResponseAuthentication-no"><a href="#ChallengeResponseAuthentication-no" class="headerlink" title="ChallengeResponseAuthentication no"></a>ChallengeResponseAuthentication no</h2><p>允许任何的密码认证!所以,任何 login.conf 规定的认证方式,均可适用!但目前我们比较喜欢使用 PAM 模块帮忙管理认证,因此这个选项可以设定为 no 喔!</p><h2 id="UsePAM-yes"><a href="#UsePAM-yes" class="headerlink" title="UsePAM yes"></a>UsePAM yes</h2><p>利用 PAM 管理使用者认证有很多好处,可以记录与管理。所以这里我们建议您使用 UsePAM 且 ChallengeResponseAuthentication 设定为 no</p><h2 id="4-3-与-Kerberos"><a href="#4-3-与-Kerberos" class="headerlink" title="4.3 与 Kerberos"></a>4.3 与 Kerberos</h2><p>有关的参数设定!因为我们没有 Kerberos 主机,所以底下不用设定!</p><p>#KerberosAuthentication no</p><p>#KerberosOrLocalPasswd yes</p><p>#KerberosTicketCleanup yes</p><p>#KerberosTgtPassing no# 4.4 底下是有关在 X-Window 底下使用的相关设定!</p><p>X11Forwarding yes</p><p>#X11DisplayOffset 10</p><p>#X11UseLocalhost yes</p><h2 id="4-5-登入后的项目"><a href="#4-5-登入后的项目" class="headerlink" title="4.5 登入后的项目:"></a>4.5 登入后的项目:</h2><h2 id="PrintMotd-no"><a href="#PrintMotd-no" class="headerlink" title="PrintMotd no"></a>PrintMotd no</h2><p>登入后是否显示出一些信息呢?例如上次登入的时间、地点等等,预设是 yes,亦即是打印出 /etc/motd 这个档案的内容。但是,如果为了安全,可以考虑改为 no !</p><h2 id="PrintLastLog-yes"><a href="#PrintLastLog-yes" class="headerlink" title="PrintLastLog yes"></a>PrintLastLog yes</h2><p>显示上次登入的信息!可以啊!预设也是 yes !</p><h2 id="KeepAlive-yes"><a href="#KeepAlive-yes" class="headerlink" title="KeepAlive yes"></a>KeepAlive yes</h2><p>一般而言,如果设定这项目的话,那么 SSH Server 会传送 KeepAlive 的讯息给Client 端,以确保两者的联机正常!在这个情况下,任何一端死掉后,SSH 可以立刻知道!而不会有僵尸程序的发生!</p><h2 id="UsePrivilegeSeparation-yes"><a href="#UsePrivilegeSeparation-yes" class="headerlink" title="UsePrivilegeSeparation yes"></a>UsePrivilegeSeparation yes</h2><p>使用者的权限设定项目!就设定为 yes 吧!</p><h2 id="MaxStartups-10"><a href="#MaxStartups-10" class="headerlink" title="MaxStartups 10"></a>MaxStartups 10</h2><p>同时允许几个尚未登入的联机画面?当我们连上 SSH ,但是尚未输入密码时,这个时候就是我们所谓的联机画面啦!在这个联机画面中,为了保护主机,所以需要设定最大值,预设最多十个联机画面,而已经建立联机的不计算在这十个当中</p><h2 id="4-6-关于使用者抵挡的设定项目"><a href="#4-6-关于使用者抵挡的设定项目" class="headerlink" title="4.6 关于使用者抵挡的设定项目:"></a>4.6 关于使用者抵挡的设定项目:</h2><h2 id="DenyUsers-1"><a href="#DenyUsers-1" class="headerlink" title="DenyUsers *"></a>DenyUsers *</h2><p>设定受抵挡的使用者名称,如果是全部的使用者,那就是全部挡吧!若是部分使用者,可以将该账号填入!例如下列!</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DenyUsers test</span><br></pre></td></tr></table></figure><h2 id="DenyGroups-test"><a href="#DenyGroups-test" class="headerlink" title="DenyGroups test"></a>DenyGroups test</h2><p>与 DenyUsers 相同!仅抵挡几个群组而已!</p><h1 id="5-sshd安全配置-防止攻击"><a href="#5-sshd安全配置-防止攻击" class="headerlink" title="5. sshd安全配置(防止攻击)"></a>5. sshd安全配置(防止攻击)</h1><ol><li>改端口号</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Port 10232</span><br></pre></td></tr></table></figure><ol start="2"><li>指定每个连接最大允许的认证次数</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MaxAuthTries 6</span><br></pre></td></tr></table></figure></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>坚持原创技术分享,您的支持将鼓励我继续创作!</div> <button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'> <span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"> <img id="wechat_qr" src="/images/wechatpay.png" alt="xueyya 微信支付"><p>微信支付</p></div><div id="alipay" style="display:inline-block"> <img id="alipay_qr" src="/images/alipay.jpg" alt="xueyya 支付宝"><p>支付宝</p></div></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> xueyya</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://yuanzi222.com/Linux SSH各配置项详解.html" title="Linux SSH各配置项详解">https://yuanzi222.com/Linux SSH各配置项详解.html</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/Linux/" rel="tag"># Linux</a></div><div class="post-widgets"><div class="social_share"><div><div class="addthis_inline_share_toolbox"><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5b63c2f14fb3c2a8" async="async"></script></div></div></div></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/后端Long类型过大时返回前端js会丢失精度问题的解决办法.html" rel="next" title="后端Long类型过大时返回前端js会丢失精度问题的解决办法"><i class="fa fa-chevron-left"></i> 后端Long类型过大时返回前端js会丢失精度问题的解决办法</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/HttpClient、HttpURLConnection、OKHttp和Volley.html" rel="prev" title="HttpClient、HttpURLConnection、OKHttp和Volley">HttpClient、HttpURLConnection、OKHttp和Volley<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article></div></div><div class="comments" id="comments"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="xueyya"><p class="site-author-name" itemprop="name">xueyya</p><p class="site-description motion-element" itemprop="description">做自己爱做的事，爱自己在做的事！</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">12</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">5</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">8</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/yuanzi222" target="_blank" title="GitHub" rel="external nofollow noopener noreferrer"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:yuanzi_222@126.com" target="_blank" title="E-Mail" rel="external nofollow noopener noreferrer"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://weibo.com/xueyya" target="_blank" title="微博" rel="external nofollow noopener noreferrer"><i class="fa fa-fw fa-weibo"></i> 微博</a></span><span class="links-of-author-item"><a href="https://www.jianshu.com/u/e722d75bf70f" target="_blank" title="简书" rel="external nofollow noopener noreferrer"><i class="fa fa-fw fa-heartbeat"></i> 简书</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="http://www.alloyteam.com/nav/" title="Web前端导航" target="_blank" rel="external nofollow noopener noreferrer">Web前端导航</a></li><li class="links-of-blogroll-item"> <a href="http://www.chuangzaoshi.com/code" title="创造狮导航" target="_blank" rel="external nofollow noopener noreferrer">创造狮导航</a></li><li class="links-of-blogroll-item"> <a href="http://www.36zhen.com/t?id=3448" title="前端书籍资料" target="_blank" rel="external nofollow noopener noreferrer">前端书籍资料</a></li><li class="links-of-blogroll-item"> <a href="http://e.xitu.io/" title="掘金酱" target="_blank" rel="external nofollow noopener noreferrer">掘金酱</a></li><li class="links-of-blogroll-item"> <a href="https://www.v2ex.com/" title="印记中文" target="_blank" rel="external nofollow noopener noreferrer">印记中文</a></li></ul></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#当前所有可以使用的配置指令如下"><span class="nav-number">1.</span> <span class="nav-text">当前所有可以使用的配置指令如下:</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#AcceptEnv"><span class="nav-number">1.1.</span> <span class="nav-text">AcceptEnv</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AddressFamily"><span class="nav-number">1.2.</span> <span class="nav-text">AddressFamily</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AllowGroups"><span class="nav-number">1.3.</span> <span class="nav-text">AllowGroups</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AllowTcpForwarding"><span class="nav-number">1.4.</span> <span class="nav-text">AllowTcpForwarding</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AllowUsers"><span class="nav-number">1.5.</span> <span class="nav-text">AllowUsers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AuthorizedKeysFile"><span class="nav-number">1.6.</span> <span class="nav-text">AuthorizedKeysFile</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Banner"><span class="nav-number">1.7.</span> <span class="nav-text">Banner</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ChallengeResponseAuthentication"><span class="nav-number">1.8.</span> <span class="nav-text">ChallengeResponseAuthentication</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ciphers"><span class="nav-number">1.9.</span> <span class="nav-text">Ciphers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ClientAliveCountMax"><span class="nav-number">1.10.</span> <span class="nav-text">ClientAliveCountMax</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ClientAliveInterval"><span class="nav-number">1.11.</span> <span class="nav-text">ClientAliveInterval</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Compression"><span class="nav-number">1.12.</span> <span class="nav-text">Compression</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DenyGroups"><span class="nav-number">1.13.</span> <span class="nav-text">DenyGroups</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DenyUsers"><span class="nav-number">1.14.</span> <span class="nav-text">DenyUsers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ForceCommand"><span class="nav-number">1.15.</span> <span class="nav-text">ForceCommand</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GatewayPorts"><span class="nav-number">1.16.</span> <span class="nav-text">GatewayPorts</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GSSAPIAuthentication"><span class="nav-number">1.17.</span> <span class="nav-text">GSSAPIAuthentication</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GSSAPICleanupCredentials"><span class="nav-number">1.18.</span> <span class="nav-text">GSSAPICleanupCredentials</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HostbasedAuthentication"><span class="nav-number">1.19.</span> <span class="nav-text">HostbasedAuthentication</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HostbasedUsesNameFromPacketOnly"><span class="nav-number">1.20.</span> <span class="nav-text">HostbasedUsesNameFromPacketOnly</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HostKey"><span class="nav-number">1.21.</span> <span class="nav-text">HostKey</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IgnoreRhosts"><span class="nav-number">1.22.</span> <span class="nav-text">IgnoreRhosts</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IgnoreUserKnownHosts"><span class="nav-number">1.23.</span> <span class="nav-text">IgnoreUserKnownHosts</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#KerberosAuthentication"><span class="nav-number">1.24.</span> <span class="nav-text">KerberosAuthentication</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#KerberosGetAFSToken"><span class="nav-number">1.25.</span> <span class="nav-text">KerberosGetAFSToken</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#KerberosOrLocalPasswd"><span class="nav-number">1.26.</span> <span class="nav-text">KerberosOrLocalPasswd</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#KerberosTicketCleanup"><span class="nav-number">1.27.</span> <span class="nav-text">KerberosTicketCleanup</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#KeyRegenerationInterval"><span class="nav-number">1.28.</span> <span class="nav-text">KeyRegenerationInterval</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ListenAddress"><span class="nav-number">1.29.</span> <span class="nav-text">ListenAddress</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ListenAddress-1"><span class="nav-number">1.30.</span> <span class="nav-text">ListenAddress</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LoginGraceTime"><span class="nav-number">1.31.</span> <span class="nav-text">LoginGraceTime</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LogLevel"><span class="nav-number">1.32.</span> <span class="nav-text">LogLevel</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MACs"><span class="nav-number">1.33.</span> <span class="nav-text">MACs</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Match"><span class="nav-number">1.34.</span> <span class="nav-text">Match</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MaxAuthTries"><span class="nav-number">1.35.</span> <span class="nav-text">MaxAuthTries</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MaxStartups"><span class="nav-number">1.36.</span> <span class="nav-text">MaxStartups</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PasswordAuthentication"><span class="nav-number">1.37.</span> <span class="nav-text">PasswordAuthentication</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PermitEmptyPasswords"><span class="nav-number">1.38.</span> <span class="nav-text">PermitEmptyPasswords</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PermitOpen"><span class="nav-number">1.39.</span> <span class="nav-text">PermitOpen</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PermitRootLogin"><span class="nav-number">1.40.</span> <span class="nav-text">PermitRootLogin</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PermitTunnel"><span class="nav-number">1.41.</span> <span class="nav-text">PermitTunnel</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PermitUserEnvironment"><span class="nav-number">1.42.</span> <span class="nav-text">PermitUserEnvironment</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PidFile"><span class="nav-number">1.43.</span> <span class="nav-text">PidFile</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Port"><span class="nav-number">1.44.</span> <span class="nav-text">Port</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PrintLastLog"><span class="nav-number">1.45.</span> <span class="nav-text">PrintLastLog</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PrintMotd"><span class="nav-number">1.46.</span> <span class="nav-text">PrintMotd</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Protocol"><span class="nav-number">1.47.</span> <span class="nav-text">Protocol</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PubkeyAuthentication"><span class="nav-number">1.48.</span> <span class="nav-text">PubkeyAuthentication</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RhostsRSAAuthentication"><span class="nav-number">1.49.</span> <span class="nav-text">RhostsRSAAuthentication</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSAAuthentication"><span class="nav-number">1.50.</span> <span class="nav-text">RSAAuthentication</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ServerKeyBits"><span class="nav-number">1.51.</span> <span class="nav-text">ServerKeyBits</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#StrictModes"><span class="nav-number">1.52.</span> <span class="nav-text">StrictModes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Subsystem"><span class="nav-number">1.53.</span> <span class="nav-text">Subsystem</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SyslogFacility"><span class="nav-number">1.54.</span> <span class="nav-text">SyslogFacility</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TCPKeepAlive"><span class="nav-number">1.55.</span> <span class="nav-text">TCPKeepAlive</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UseDNS"><span class="nav-number">1.56.</span> <span class="nav-text">UseDNS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UseLogin"><span class="nav-number">1.57.</span> <span class="nav-text">UseLogin</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UsePrivilegeSeparation"><span class="nav-number">1.58.</span> <span class="nav-text">UsePrivilegeSeparation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#X11DisplayOffset"><span class="nav-number">1.59.</span> <span class="nav-text">X11DisplayOffset</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#X11Forwarding"><span class="nav-number">1.60.</span> <span class="nav-text">X11Forwarding</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#X11UseLocalhost"><span class="nav-number">1.61.</span> <span class="nav-text">X11UseLocalhost</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#XAuthLocation"><span class="nav-number">1.62.</span> <span class="nav-text">XAuthLocation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#时间格式"><span class="nav-number">1.63.</span> <span class="nav-text">时间格式</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#OpenBSD-4-2-January-1-2008-9Vbird网络篇里的说明："><span class="nav-number">2.</span> <span class="nav-text">OpenBSD 4.2 January 1, 2008 9Vbird网络篇里的说明：</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1-关于-SSH-Server-的整体设定-包含使用的-port-啦-以及使用的密码演算方式"><span class="nav-number">3.</span> <span class="nav-text">1. 关于 SSH Server 的整体设定,包含使用的 port 啦,以及使用的密码演算方式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Port-22"><span class="nav-number">3.1.</span> <span class="nav-text">Port 22</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rotocol-1-2"><span class="nav-number">3.2.</span> <span class="nav-text">rotocol 1,2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ListenAddress-0-0-0-0"><span class="nav-number">3.3.</span> <span class="nav-text">ListenAddress 0.0.0.0</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PidFile-var-run-sshd-pid"><span class="nav-number">3.4.</span> <span class="nav-text">PidFile /var/run/sshd.pid</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LoginGraceTime-2m"><span class="nav-number">3.5.</span> <span class="nav-text">LoginGraceTime 2m</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Compression-yes"><span class="nav-number">3.6.</span> <span class="nav-text">Compression yes</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-说明主机的-Private-Key-放置的档案-预设使用下面的档案即可"><span class="nav-number">4.</span> <span class="nav-text">2. 说明主机的 Private Key 放置的档案,预设使用下面的档案即可!</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-关于-version-1-的一些设定"><span class="nav-number">4.1.</span> <span class="nav-text">2.1 关于 version 1 的一些设定!</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#KeyRegenerationInterval-1h"><span class="nav-number">4.2.</span> <span class="nav-text">KeyRegenerationInterval 1h</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ServerKeyBits-768"><span class="nav-number">4.3.</span> <span class="nav-text">ServerKeyBits 768</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-关于登录文件的讯息数据放置与-daemon-的名称"><span class="nav-number">5.</span> <span class="nav-text">3. 关于登录文件的讯息数据放置与 daemon 的名称!</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SyslogFacility-AUTHPRIV"><span class="nav-number">5.1.</span> <span class="nav-text">SyslogFacility AUTHPRIV</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LogLevel-INFO"><span class="nav-number">5.2.</span> <span class="nav-text">LogLevel INFO</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-安全设定项目-极重要"><span class="nav-number">6.</span> <span class="nav-text">4. 安全设定项目!极重要!</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-登入设定部分"><span class="nav-number">6.1.</span> <span class="nav-text">4.1 登入设定部分</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PermitRootLogin-no"><span class="nav-number">6.2.</span> <span class="nav-text">PermitRootLogin no</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UserLogin-no"><span class="nav-number">6.3.</span> <span class="nav-text">UserLogin no</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#StrictModes-yes"><span class="nav-number">6.4.</span> <span class="nav-text">StrictModes yes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSAAuthentication-yes"><span class="nav-number">6.5.</span> <span class="nav-text">RSAAuthentication yes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PubkeyAuthentication-yes"><span class="nav-number">6.6.</span> <span class="nav-text">PubkeyAuthentication yes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AuthorizedKeysFile-ssh-authorized-keys"><span class="nav-number">6.7.</span> <span class="nav-text">AuthorizedKeysFile .ssh/authorized_keys</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-认证部分"><span class="nav-number">6.8.</span> <span class="nav-text">4.2 认证部分</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RhostsAuthentication-no"><span class="nav-number">6.9.</span> <span class="nav-text">RhostsAuthentication no</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IgnoreRhosts-yes"><span class="nav-number">6.10.</span> <span class="nav-text">IgnoreRhosts yes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RhostsRSAAuthentication-no"><span class="nav-number">6.11.</span> <span class="nav-text">RhostsRSAAuthentication no</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HostbasedAuthentication-no"><span class="nav-number">6.12.</span> <span class="nav-text">HostbasedAuthentication no</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IgnoreUserKnownHosts-no"><span class="nav-number">6.13.</span> <span class="nav-text">IgnoreUserKnownHosts no</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PasswordAuthentication-yes"><span class="nav-number">6.14.</span> <span class="nav-text">PasswordAuthentication yes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PermitEmptyPasswords-no"><span class="nav-number">6.15.</span> <span class="nav-text">PermitEmptyPasswords no</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ChallengeResponseAuthentication-no"><span class="nav-number">6.16.</span> <span class="nav-text">ChallengeResponseAuthentication no</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UsePAM-yes"><span class="nav-number">6.17.</span> <span class="nav-text">UsePAM yes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-与-Kerberos"><span class="nav-number">6.18.</span> <span class="nav-text">4.3 与 Kerberos</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-5-登入后的项目"><span class="nav-number">6.19.</span> <span class="nav-text">4.5 登入后的项目:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PrintMotd-no"><span class="nav-number">6.20.</span> <span class="nav-text">PrintMotd no</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PrintLastLog-yes"><span class="nav-number">6.21.</span> <span class="nav-text">PrintLastLog yes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#KeepAlive-yes"><span class="nav-number">6.22.</span> <span class="nav-text">KeepAlive yes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UsePrivilegeSeparation-yes"><span class="nav-number">6.23.</span> <span class="nav-text">UsePrivilegeSeparation yes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MaxStartups-10"><span class="nav-number">6.24.</span> <span class="nav-text">MaxStartups 10</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-6-关于使用者抵挡的设定项目"><span class="nav-number">6.25.</span> <span class="nav-text">4.6 关于使用者抵挡的设定项目:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DenyUsers-1"><span class="nav-number">6.26.</span> <span class="nav-text">DenyUsers *</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DenyGroups-test"><span class="nav-number">6.27.</span> <span class="nav-text">DenyGroups test</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-sshd安全配置-防止攻击"><span class="nav-number">7.</span> <span class="nav-text">5. sshd安全配置(防止攻击)</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2019</span><span class="with-love" id="animate"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">xueyya</span> <span class="post-meta-divider">|</span> <span>Hosted by <a href="https://pages.coding.me" style="font-weight:700" rel="external nofollow noopener noreferrer" target="_blank">Coding Pages</a></span></div><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-pv" title="总访问量"><i class="fa fa-eye"></i> <span class="busuanzi-value" id="busuanzi_container_site_pv">总访问量：<span id="busuanzi_value_site_pv"></span>次</span></span> <span class="post-meta-divider">|</span><span class="site-uv" title="总访客"><i class="fa fa-user-md"></i> <span class="busuanzi-value" id="busuanzi_container_site_uv">总访客：<span id="busuanzi_value_site_uv"></span>人</span></span> <span class="post-meta-divider">|</span><div class="theme-info"><i class="fa fa-pencil"></i> <span class="post-count">博客全站共21.8k字</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script><script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=6.3.0"></script><script type="text/javascript" src="/js/src/post-details.js?v=6.3.0"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script type="text/javascript">var GUEST=["nick","mail","link"],guest="nick,mail,link";guest=guest.split(",").filter(function(e){return-1<GUEST.indexOf(e)}),new Valine({el:"#comments",verify:!1,notify:!1,appId:"U4ofFL3yrPHQ5lzAXmNild0r-gzGzoHsz",appKey:"euarJ4EKiCu2iNrIzC8WMWGn",placeholder:"老铁，你不想说两句吗?",avatar:"wavatar",meta:guest,pageSize:"10",visitor:!1})</script><script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script></body></html>